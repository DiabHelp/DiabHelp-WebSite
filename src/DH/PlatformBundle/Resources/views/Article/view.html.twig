{# src/DH/PlatformBundle/Resources/views/Article/view.html.twig #}

{% extends "DHPlatformBundle::slide.html.twig" %}

{% block title %}
  {{ article.title }} - {{ parent() }}
{% endblock %}

{% block dhplatform_body %}

  <div id="content">
    <div class = "page_header">
      <div class= center >
        <img class="page_header_logo fl" src="{{ asset('bundles/dhplatform/images/news_logo.png') }}" alt="">
        <h1 class="page_header_title fl">{{ article.title }}</h1>
        <ul class="page_header_nav fr">
          <li><a href="{{ path('dh_platform_home') }}">Accueil</a></li>
          <li><a class="active" href="{{ path('dh_platform_article') }}">News</a></li>
        </ul>
        <div class="cf"></div>
      </div>
    </div>
    <div class=news_content>

    {{ include("DHPlatformBundle:Article:archiveMenu.html.twig") }}

       <div class=news_content_left fl>
         <div class=news_item>
           <div class= center>
             <img style="width:100%" src="{{ article.imgPath }}" border="0"/>
             <h2 class=news_item_date>{{ article.date|date('d/m/Y') }}</h2>
             <h2 class=news_item_title>{{ article.title }}</h2>
               <a class="fbShareButtonNews"><img src='{{ asset('bundles/dhplatform/images/sharefb.jpeg') }}'/></a>
             <div id = Text_News>
               <p class=news_content>{{ article.text }}</p>
             </div>
             <h2 class="contact_form_title" style="color:#474747;">Vous voulez poster un commentaire ?</h2>
             </div>
            {% if app.user %}
                <div id="comSend" style="position:relative;margin-bottom:10px" >
                    {{ form_start(form, {'attr': {'class': 'form-vertical'}}) }}
                    <div class="error">
                        {{ form_errors(form) }}
                    </div>
                    <div align="center">
                        {{ form_widget(form.text, {'attr': {'class': 'texteareaCommentNews', 'rows' : 10, 'cols' : 100, 'placeholder' : 'Votre commentaire ici..'}}) }}
                    </div>
                    <div align="center">
                        {{ form_widget(form.envoyer, {'attr': {'class': 'submitCommentNews', 'value' : 'Envoyer'}}) }}
                    </div>
                    {{ form_end(form) }}
                </div>
            {% else %}
                <p style="font-size:1.8em;font-style:bold;text-align:center;color:#474747"> Vous devez être <span onclick="show_signup()"  style="color:blue;"><a>connecté</a></span> afin de poster un commentaire</p>
            {% endif %}
			<div class=news_opened_info>
				<div class=news_opened_info_author fl><p>{{ article.author.username }}</p></div>
				<div class=news_opened_info_comments fl><p><span>{{ article.comments|length }}</span>Commentaires</p></div>
				<div class=news_opened_info_date fl><p>{{ article.date|date('d/m/Y H:i:s') }}</p></div>
				<div class=news_opened_info_category fl><p>Information</p></div>
				<br/>
			</div>
         </div>
		<button type="button"  id="button_com_react" onclick="show_com_content('com_react_content');" >Afficher les {{ article.comments|length }} commentaires</button>
        <div id="com_react_content" style="height:auto; display:none;">
            {% for comment in article.comments %}
            <div class="simple_com">
                <div class="header_com">
                    <div id="header_com_gauche">
                        <img src="" alt="user" class="icone_picture_user">
                        <h3>{{ comment.author.username }}</h3>
                    </div>
                    <div id="header_com_droite">
                              {#<?php if (isset($_SESSION['id']) && $_SESSION['id'] != ""){#}
                                  {#$id = $_SESSION['id'];#}
                                      {#if ($id == 0){ ?>#}
                                          {#<div class="action_block">#}
                                              {#<div class="delete_com">#}
                                                  {#<a style="background-color:red;" <?php echo 'href="src/deleteCom.php?com='.$data["com_id"].'"';?> >Supprimer</a>#}
                                              {#</div>#}
                                              {#<div class="modify_com">#}
                                                      {#<a style="background-color:gray" <?php echo 'onclick="show_com_modification_form(\'modif_com_form'.$data['com_id'].'\',\''.'text_com'.$data['com_id'].'\');"' ?> >Modifier</a>#}
                                              {#</div>#}
                                          {#</div>#}
                                      {#<?php }#}
                        <div class="action_block">
                            {% if app.user and comment.author.id == app.user.id and loop.last %}
                                <div class="delete_com">
                                    <a style="background-color:red;" href="{{ path('dh_platform_article_comment_delete', {'id': comment.id}) }}">Supprimer</a>
                                </div>
                            {% endif %}
                            {% if app.user and comment.author.id == app.user.id %}
                                <div class="modify_com">
                                    <a style="background-color:gray" onclick="">Modifier</a>
                                </div>
                            {% endif %}
                        </div>
                        <h4>{{ comment.date|date('d/m/Y H:i:s') }}</h4>
                    </div>
                </div>
                <div class="content_com">
                    <p id=com_info_msg" style="display:none"></p>
                    <div id=text_com>
                        <p>{{ comment.text }}</p>
                    </div>
                    <form action="" id=modif_com_form style="width:100%;display:none;">
                        <div align="center">
                            <textarea rows="10" cols="100" class="com_change" id=com_change>{{ comment.text }}</textarea>
                        </div>
                        <div align="center">
                            <input name="envoyer" class="send_button" id="envoyer" value="Envoyer" />
                        </div>
                    </form>
                </div>
            </div>
            {% endfor %}
        </div>
       </div>
    </div>
  </div>

    {#<h4 style="color:#474747;">Commentaires :</h4>#}

    {#{% for comment in article.comments %}#}
    {#<p>text : {{ comment.text }}</p>#}
    {#<p>user : {{ comment.author.username }}</p>#}
    {#<p>date : {{ comment.date|date('d/m/Y') }}</p>#}
    {#{% endfor %}#}

    {#<h4 style="color:#474747;">Ajouter un commentaire</h4>#}
    {#<div class="well">#}
    {#{{ form(form) }}#}
    {#</div>#}

{% endblock %}